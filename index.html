<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no">
    <title>Supplement Tracker</title>
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link href="https://fonts.googleapis.com/css2?family=Outfit:wght@300;400;500;600;700&display=swap" rel="stylesheet">
    <style>
        :root {
            --bg: #0a0a0f;
            --card: #12121a;
            --accent: #6366f1;
            --success: #10b981;
            --text: #f1f5f9;
            --text-dim: #64748b;
            --border: #1e1e2e;
            --warning: #f59e0b;
        }

        .light-mode {
            --bg: #f8fafc;
            --card: #ffffff;
            --text: #0f172a;
            --text-dim: #64748b;
            --border: #e2e8f0;
        }

        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
            -webkit-tap-highlight-color: transparent;
        }

        body {
            font-family: 'Outfit', sans-serif;
            background: var(--bg);
            color: var(--text);
            min-height: 100vh;
            background-image: 
                radial-gradient(ellipse at 20% 0%, rgba(99, 102, 241, 0.15) 0%, transparent 50%),
                radial-gradient(ellipse at 80% 100%, rgba(16, 185, 129, 0.1) 0%, transparent 50%);
            transition: background 0.3s ease;
        }

        .light-mode body {
            background-image: 
                radial-gradient(ellipse at 20% 0%, rgba(99, 102, 241, 0.1) 0%, transparent 50%),
                radial-gradient(ellipse at 80% 100%, rgba(16, 185, 129, 0.05) 0%, transparent 50%);
        }

        .container {
            max-width: 420px;
            margin: 0 auto;
            padding: 24px 16px;
            min-height: 100vh;
        }

        header {
            display: flex;
            justify-content: space-between;
            align-items: center;
            margin-bottom: 24px;
        }

        .header-left h1 {
            font-size: 28px;
            font-weight: 600;
            letter-spacing: -0.5px;
        }

        .header-left .date {
            font-size: 13px;
            color: var(--text-dim);
            margin-top: 4px;
        }

        .theme-toggle {
            background: var(--card);
            border: 1px solid var(--border);
            border-radius: 12px;
            padding: 10px;
            cursor: pointer;
        }

        .theme-toggle svg {
            width: 20px;
            height: 20px;
            stroke: var(--text);
            fill: none;
        }

        .streak-banner {
            background: linear-gradient(135deg, var(--card) 0%, #1a1a25 100%);
            border: 1px solid var(--border);
            border-radius: 16px;
            padding: 20px;
            margin-bottom: 24px;
            display: flex;
            align-items: center;
            justify-content: space-between;
        }

        .light-mode .streak-banner {
            background: linear-gradient(135deg, var(--card) 0%, #f1f5f9 100%);
        }

        .streak-info h2 {
            font-size: 14px;
            color: var(--text-dim);
            font-weight: 400;
            margin-bottom: 4px;
        }

        .streak-count {
            font-size: 32px;
            font-weight: 700;
            color: var(--success);
            text-shadow: 0 0 30px rgba(16, 185, 129, 0.4);
        }

        .streak-label {
            font-size: 12px;
            color: var(--text-dim);
        }

        .progress-ring {
            width: 64px;
            height: 64px;
            position: relative;
        }

        .progress-ring svg {
            transform: rotate(-90deg);
            width: 64px;
            height: 64px;
        }

        .progress-ring circle {
            fill: none;
            stroke-width: 5;
            stroke-linecap: round;
        }

        .progress-ring .bg {
            stroke: var(--border);
        }

        .progress-ring .progress {
            stroke: var(--success);
            stroke-dasharray: 176;
            stroke-dashoffset: 176;
            transition: stroke-dashoffset 0.8s ease-out;
        }

        .progress-text {
            position: absolute;
            top: 50%;
            left: 50%;
            transform: translate(-50%, -50%);
            font-size: 14px;
            font-weight: 600;
        }

        .weekly-stats {
            background: var(--card);
            border: 1px solid var(--border);
            border-radius: 14px;
            padding: 16px;
            margin-bottom: 20px;
        }

        .weekly-stats h3 {
            font-size: 13px;
            color: var(--text-dim);
            font-weight: 500;
            margin-bottom: 12px;
        }

        .week-days {
            display: flex;
            justify-content: space-between;
        }

        .week-day {
            display: flex;
            flex-direction: column;
            align-items: center;
            gap: 6px;
        }

        .week-day .day {
            font-size: 11px;
            color: var(--text-dim);
        }

        .week-day .dot {
            width: 28px;
            height: 28px;
            border-radius: 8px;
            background: var(--border);
            display: flex;
            align-items: center;
            justify-content: center;
            font-size: 12px;
            font-weight: 600;
            color: var(--text-dim);
        }

        .week-day .dot.complete {
            background: var(--success);
            color: white;
        }

        .week-day .dot.partial {
            background: var(--warning);
            color: white;
        }

        .supplements {
            display: flex;
            flex-direction: column;
            gap: 12px;
        }

        .supplement-card {
            background: var(--card);
            border: 1px solid var(--border);
            border-radius: 14px;
            padding: 16px;
            display: flex;
            align-items: center;
            justify-content: space-between;
            cursor: pointer;
            transition: all 0.2s ease;
        }

        .supplement-card.completed {
            border-color: rgba(16, 185, 129, 0.3);
            background: linear-gradient(135deg, var(--card) 0%, rgba(16, 185, 129, 0.08) 100%);
        }

        .supplement-card:active {
            transform: scale(0.98);
        }

        .supplement-info {
            display: flex;
            align-items: center;
            gap: 14px;
        }

        .checkbox {
            width: 26px;
            height: 26px;
            border-radius: 8px;
            border: 2px solid var(--border);
            display: flex;
            align-items: center;
            justify-content: center;
            transition: all 0.2s ease;
            flex-shrink: 0;
        }

        .supplement-card.completed .checkbox {
            background: var(--success);
            border-color: var(--success);
        }

        .checkbox svg {
            width: 14px;
            height: 14px;
            stroke: var(--bg);
            stroke-width: 3;
            opacity: 0;
            transform: scale(0);
            transition: all 0.2s ease;
        }

        .supplement-card.completed .checkbox svg {
            opacity: 1;
            transform: scale(1);
        }

        .supplement-name {
            font-size: 15px;
            font-weight: 500;
        }

        .supplement-card.completed .supplement-name {
            color: var(--text-dim);
        }

        .supplement-dosage {
            font-size: 12px;
            color: var(--text-dim);
            margin-top: 2px;
        }

        .supplement-streak {
            display: flex;
            align-items: center;
            gap: 4px;
            font-size: 12px;
            color: var(--accent);
            font-weight: 500;
        }

        .supplement-streak svg {
            width: 12px;
            height: 12px;
        }

        .add-btn {
            background: linear-gradient(135deg, var(--accent) 0%, #4f46e5 100%);
            border: none;
            border-radius: 14px;
            padding: 16px;
            color: white;
            font-size: 15px;
            font-weight: 500;
            cursor: pointer;
            display: flex;
            align-items: center;
            justify-content: center;
            gap: 8px;
            margin-top: 16px;
            box-shadow: 0 4px 20px rgba(99, 102, 241, 0.3);
            font-family: inherit;
        }

        .add-btn:hover {
            transform: translateY(-2px);
        }

        .add-btn svg {
            width: 18px;
            height: 18px;
        }

        /* Modal */
        .modal-overlay {
            position: fixed;
            top: 0;
            left: 0;
            right: 0;
            bottom: 0;
            background: rgba(0, 0, 0, 0.7);
            backdrop-filter: blur(4px);
            display: flex;
            align-items: center;
            justify-content: center;
            z-index: 100;
            opacity: 0;
            visibility: hidden;
            transition: all 0.3s ease;
            padding: 20px;
        }

        .modal-overlay.active {
            opacity: 1;
            visibility: visible;
        }

        .modal {
            background: var(--card);
            border: 1px solid var(--border);
            border-radius: 20px;
            padding: 28px;
            width: 100%;
            max-width: 340px;
            transform: scale(0.9) translateY(20px);
            transition: all 0.3s ease;
        }

        .modal-overlay.active .modal {
            transform: scale(1) translateY(0);
        }

        .modal h3 {
            font-size: 18px;
            font-weight: 600;
            margin-bottom: 20px;
        }

        .modal input {
            width: 100%;
            background: var(--bg);
            border: 1px solid var(--border);
            border-radius: 12px;
            padding: 14px 16px;
            color: var(--text);
            font-size: 15px;
            font-family: inherit;
            margin-bottom: 12px;
        }

        .modal input:focus {
            outline: none;
            border-color: var(--accent);
        }

        .modal input::placeholder {
            color: var(--text-dim);
        }

        .modal-buttons {
            display: flex;
            gap: 10px;
            margin-top: 20px;
        }

        .modal-btn {
            flex: 1;
            padding: 14px;
            border-radius: 12px;
            font-size: 14px;
            font-weight: 500;
            cursor: pointer;
            font-family: inherit;
        }

        .modal-btn.cancel {
            background: transparent;
            border: 1px solid var(--border);
            color: var(--text-dim);
        }

        .modal-btn.save {
            background: var(--accent);
            border: none;
            color: white;
        }

        .empty-state {
            text-align: center;
            padding: 40px 20px;
            color: var(--text-dim);
        }

        .empty-state svg {
            width: 48px;
            height: 48px;
            margin-bottom: 16px;
            opacity: 0.5;
        }

        .empty-state p {
            font-size: 14px;
        }
    </style>
</head>
<body>
    <div class="container">
        <header>
            <div class="header-left">
                <h1>Supplements</h1>
                <div class="date" id="currentDate"></div>
            </div>
            <button class="theme-toggle" id="themeToggle" title="Toggle theme">
                <svg viewBox="0 0 24 24" stroke-width="2" stroke-linecap="round" stroke-linejoin="round">
                    <circle cx="12" cy="12" r="5"></circle>
                    <line x1="12" y1="1" x2="12" y2="3"></line>
                    <line x1="12" y1="21" x2="12" y2="23"></line>
                    <line x1="4.22" y1="4.22" x2="5.64" y2="5.64"></line>
                    <line x1="18.36" y1="18.36" x2="19.78" y2="19.78"></line>
                    <line x1="1" y1="12" x2="3" y2="12"></line>
                    <line x1="21" y1="12" x2="23" y2="12"></line>
                    <line x1="4.22" y1="19.78" x2="5.64" y2="18.36"></line>
                    <line x1="18.36" y1="5.64" x2="19.78" y2="4.22"></line>
                </svg>
            </button>
        </header>

        <div class="streak-banner">
            <div class="streak-info">
                <h2>Today's Streak</h2>
                <div class="streak-count" id="streakCount">0</div>
                <div class="streak-label">days</div>
            </div>
            <div class="progress-ring">
                <svg>
                    <circle class="bg" cx="32" cy="32" r="28"></circle>
                    <circle class="progress" id="progressRing" cx="32" cy="32" r="28"></circle>
                </svg>
                <div class="progress-text" id="progressText">0%</div>
            </div>
        </div>

        <div class="weekly-stats">
            <h3>This Week</h3>
            <div class="week-days" id="weekDays"></div>
        </div>

        <div class="supplements" id="supplementsList"></div>

        <button class="add-btn" id="addBtn">
            <svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                <line x1="12" y1="5" x2="12" y2="19"></line>
                <line x1="5" y1="12" x2="19" y2="12"></line>
            </svg>
            Add Supplement
        </button>
    </div>

    <!-- Add Modal -->
    <div class="modal-overlay" id="modalOverlay">
        <div class="modal">
            <h3>Add Supplement</h3>
            <input type="text" id="supplementName" placeholder="Name (e.g., Vitamin D3)">
            <input type="text" id="supplementDosage" placeholder="Dosage (e.g., 5000 IU)">
            <div class="modal-buttons">
                <button class="modal-btn cancel" id="cancelBtn">Cancel</button>
                <button class="modal-btn save" id="saveBtn">Save</button>
            </div>
        </div>
    </div>

    <script>
        const state = {
            supplements: [],
            completed: {},
            currentStreak: 0,
            theme: 'dark'
        };

        function loadState() {
            const saved = localStorage.getItem('supplements');
            const completed = localStorage.getItem('completed');
            const streak = localStorage.getItem('streak');
            const theme = localStorage.getItem('theme');

            if (saved) state.supplements = JSON.parse(saved);
            if (completed) state.completed = JSON.parse(completed);
            if (streak) state.currentStreak = parseInt(streak);
            if (theme) state.theme = theme;

            if (state.supplements.length === 0) {
                state.supplements = [
                    { id: 1, name: 'Vitamin D3', dosage: '5000 IU', streak: 0 },
                    { id: 2, name: 'Omega-3', dosage: '2000mg', streak: 0 },
                    { id: 3, name: 'Magnesium', dosage: '400mg', streak: 0 },
                    { id: 4, name: 'Zinc', dosage: '30mg', streak: 0 }
                ];
                saveState();
            }

            if (state.theme === 'light') {
                document.body.classList.add('light-mode');
            }
        }

        function saveState() {
            localStorage.setItem('supplements', JSON.stringify(state.supplements));
            localStorage.setItem('completed', JSON.stringify(state.completed));
            localStorage.setItem('streak', state.currentStreak.toString());
            localStorage.setItem('theme', state.theme);
        }

        function getTodayKey() {
            return new Date().toISOString().split('T')[0];
        }

        function getWeekDays() {
            const days = [];
            const today = new Date();
            for (let i = 6; i >= 0; i--) {
                const d = new Date(today);
                d.setDate(d.getDate() - i);
                days.push({
                    day: d.toLocaleDateString('en-US', { weekday: 'short' }).charAt(0),
                    date: d.toISOString().split('T')[0]
                });
            }
            return days;
        }

        function render() {
            const list = document.getElementById('supplementsList');
            
            document.getElementById('currentDate').textContent = new Date().toLocaleDateString('en-US', {
                weekday: 'long',
                month: 'long',
                day: 'numeric'
            });

            const todayKey = getTodayKey();
            const completedToday = state.completed[todayKey] || [];

            if (state.supplements.length === 0) {
                list.innerHTML = `
                    <div class="empty-state">
                        <svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="1.5">
                            <path d="M12 2L2 7l10 5 10-5-10-5zM2 17l10 5 10-5M2 12l10 5 10-5"/>
                        </svg>
                        <p>No supplements added yet</p>
                    </div>
                `;
                return;
            }

            list.innerHTML = state.supplements.map(supp => {
                const isCompleted = completedToday.includes(supp.id);
                return `
                    <div class="supplement-card ${isCompleted ? 'completed' : ''}" data-id="${supp.id}">
                        <div class="supplement-info">
                            <div class="checkbox">
                                <svg viewBox="0 0 24 24" fill="none" stroke="currentColor">
                                    <polyline points="20 6 9 17 4 12"></polyline>
                                </svg>
                            </div>
                            <div>
                                <div class="supplement-name">${supp.name}</div>
                                <div class="supplement-dosage">${supp.dosage}</div>
                            </div>
                        </div>
                        <div class="supplement-streak">
                            <svg viewBox="0 0 24 24" fill="currentColor">
                                <path d="M12 2C6.48 2 2 6.48 2 12s4.48 10 10 10 10-4.48 10-10S17.52 2 12 2zm-2 15l-5-5 1.41-1.41L10 14.17l7.59-7.59L19 8l-9 9z"/>
                            </svg>
                            ${supp.streak || 0}
                        </div>
                    </div>
                `;
            }).join('');

            const completed = completedToday.length;
            const total = state.supplements.length;
            const percentage = total > 0 ? Math.round((completed / total) * 100) : 0;
            
            document.getElementById('streakCount').textContent = state.currentStreak;
            
            const circumference = 2 * Math.PI * 28;
            const offset = circumference - (percentage / 100) * circumference;
            
            document.getElementById('progressRing').style.strokeDashoffset = offset;
            document.getElementById('progressText').textContent = `${percentage}%`;

            renderWeekStats();

            document.querySelectorAll('.supplement-card').forEach(card => {
                card.addEventListener('click', () => toggleSupplement(card.dataset.id));
                card.addEventListener('contextmenu', (e) => {
                    e.preventDefault();
                    deleteSupplement(card.dataset.id);
                });
            });
        }

        function renderWeekStats() {
            const weekDays = getWeekDays();
            const container = document.getElementById('weekDays');
            const todayKey = getTodayKey();
            
            container.innerHTML = weekDays.map(day => {
                const dayCompleted = state.completed[day.date] || [];
                const completed = dayCompleted.length;
                const total = state.supplements.length;
                
                let dotClass = 'dot';
                if (day.date === todayKey) {
                    if (completed === total && total > 0) dotClass += ' complete';
                    else if (completed > 0) dotClass += ' partial';
                } else {
                    const isComplete = completed === total && total > 0;
                    const isPartial = completed > 0 && completed < total;
                    if (isComplete) dotClass += ' complete';
                    else if (isPartial) dotClass += ' partial';
                }
                
                return `
                    <div class="week-day">
                        <div class="${dotClass}">${day.date === todayKey ? completed + '/' + total : (completed === total && total > 0 ? 'âœ“' : '-')}</div>
                        <div class="day">${day.day}</div>
                    </div>
                `;
            }).join('');
        }

        function toggleSupplement(id) {
            const suppId = parseInt(id);
            const key = getTodayKey();
            
            if (!state.completed[key]) {
                state.completed[key] = [];
            }
            
            const index = state.completed[key].indexOf(suppId);
            const supplement = state.supplements.find(s => s.id === suppId);

            if (index === -1) {
                state.completed[key].push(suppId);
                supplement.streak = (supplement.streak || 0) + 1;
                
                if (state.completed[key].length === state.supplements.length) {
                    state.currentStreak++;
                }
            } else {
                state.completed[key].splice(index, 1);
                supplement.streak = Math.max(0, (supplement.streak || 1) - 1);
            }

            saveState();
            render();
        }

        function addSupplement(name, dosage) {
            const newId = Math.max(0, ...state.supplements.map(s => s.id)) + 1;
            state.supplements.push({
                id: newId,
                name: name,
                dosage: dosage || 'As directed',
                streak: 0
            });
            saveState();
            render();
        }

        function deleteSupplement(id) {
            if (confirm('Delete this supplement?')) {
                state.supplements = state.supplements.filter(s => s.id !== parseInt(id));
                Object.keys(state.completed).forEach(key => {
                    state.completed[key] = state.completed[key].filter(c => c !== parseInt(id));
                });
                saveState();
                render();
            }
        }

        document.getElementById('themeToggle').addEventListener('click', () => {
            state.theme = state.theme === 'dark' ? 'light' : 'dark';
            document.body.classList.toggle('light-mode');
            saveState();
        });

        const modalOverlay = document.getElementById('modalOverlay');
        const addBtn = document.getElementById('addBtn');
        const cancelBtn = document.getElementById('cancelBtn');
        const saveBtn = document.getElementById('saveBtn');
        const nameInput = document.getElementById('supplementName');
        const dosageInput = document.getElementById('supplementDosage');

        addBtn.addEventListener('click', () => {
            modalOverlay.classList.add('active');
            nameInput.focus();
        });

        cancelBtn.addEventListener('click', () => {
            modalOverlay.classList.remove('active');
            nameInput.value = '';
            dosageInput.value = '';
        });

        saveBtn.addEventListener('click', () => {
            const name = nameInput.value.trim();
            const dosage = dosageInput.value.trim();
            if (name) {
                addSupplement(name, dosage);
                modalOverlay.classList.remove('active');
                nameInput.value = '';
                dosageInput.value = '';
            }
        });

        modalOverlay.addEventListener('click', (e) => {
            if (e.target === modalOverlay) {
                modalOverlay.classList.remove('active');
            }
        });

        loadState();
        render();
    </script>
</body>
</html>
